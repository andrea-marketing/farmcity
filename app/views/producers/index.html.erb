<div class="container">
  <div class="row justify-content-center">

    <div class="col-12 col-lg-6">
      <p> Hello <i class="highlight"> <%=current_user.first_name %> </i> 👋🏼 !! </p>

      <div class="search" data-controller="disable-address">
        <% if @address.present? %>
          <a class="btn-link-search" data-action="click->disable-address#disable" data-disable-address-target="button" ><i class="fa-solid fa-map-pin"></i>&nbsp&nbsp<%= params[:address] %></a>
        <% else %>
          <a class="btn-link-search" data-action="click->disable-address#disable" data-disable-address-target="button" ><i class="fa-solid fa-map-pin"></i>&nbsp&nbsp Search by address</a>
        <% end %>
          <!-- New search bar judith -->
          <%= form_tag producers_path, method: :get do %>
            <%= text_field_tag :address,
                  params[:address],
                  data: { disable_address_target: "input" },
                  # wrapper_html: { data: { controller: "disable-address"}},
                  class: "form-control d-none",
                  id: "searchbar-index",
                  placeholder: "Enter an address",
                  value: @address
                %>
            <%= text_field_tag :query,
              params[:query],
              class: "form-control",
              id: "searchbar-index",
              placeholder: "Find a producer"
            %>
            <%= submit_tag "Search", :name => nil, class: "d-none" %>
          <% end %>
      </div>

      <h2>Categories</h2>

      <div class="filters" data-controller= "filter-button">
        <div >
          <% @categories.each do |category| %>
            <input type="checkbox" name="" id="<%=category.id %>" class="filter" data-filter-button-target= "category" data-action="click->filter-button#filter">
            <label for="<%=category.id %>" ><%= category %></label>
          <% end %>
        </div>
      </div>

    <h2 class="producers">Producers</h2>
      <div data-controller="mapbox"
            data-mapbox-markers-value="<%= @markers.to_json %>"
            data-mapbox-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
            <div class="sticky">
              <button id="bouton-map" data-action="click->mapbox#display"><i class="fa-solid fa-map-location-dot white-icon"></i> Map</button>
            </div>
          <div style="width: 100%; height: 100vh; position: absolute; top: -100vh"
            data-mapbox-target= "map">
        </div>
      </div>
      <!-- list of producers -->

      <div class="cards">
          <%= render "producers", producers: @producers %>
      </div>

      <!-- Add new producer profile -->


    </div>

  </div>
  </div>
</div>
