<div class="container">

  <!-- Producer info -->

  <% @producer.photos.each do |photo| %>
    <%= cl_image_tag photo.key, height: 300, width: 400, crop: :fill %>
  <% end %>
  <h1><%=@producer.name.capitalize%>, <%=@producer.producer_type.capitalize%></h1>
  <p><%=@producer.address%></p>
  <br>
  <p><%=@producer.description%></p>
  <br>

  <p>For more informations, contact me at <%=@producer.contact%></p>

   <!-- Add/destroy producer  -->

  <div class="buttons">
    <% if policy(@producer).edit? %>
      <%= link_to "Update", edit_producer_path(@producer) %>
    <% end %>

    <% if policy(@producer).destroy? %>
      <%= link_to "Delete", producer_path(@producer),
                    method: :delete,
                    data: { confirm: "Are you sure?" } ,
                    class:"btn-red"%>
    <% end %>
   <%= link_to 'Back', producers_path %>

  </div>

  <h2>Products</h2>
  <!-- New product  -->

  <% if policy(Product).create? %>
    <%= link_to "New Product", new_producer_product_path(@producer, @product) %>
  <% end %>

  <!-- Product list -->

  <% @producer.products.each do |product| %>
    <div class="card-product">
      <%= cl_image_tag product.photo.key, height: 300, width: 400, crop: :fill %>
      <div class="card-product-infos">
        <h3><%= product.name %></h3>
        <p><%= product.product_type %></p>
        <p><%= product.description %></p>
        <p><%= product.price %></p>
        <%= link_to 'Edit',  edit_producer_product_path(@producer, product) %>
        <%= link_to "Delete",
            producer_product_path(@producer, product),
            method: :delete,
            data: { confirm: "Are you sure?" } %>
       </div>
    </div>
  <% end %>

  <h2>Reviews</h2>

  <!-- New review  -->

  <% if policy(Review).create? %>
     <%= link_to 'Leave a review', new_producer_review_path(@producer) %>
  <%end%>

  <!--  Reviews -->

  <% @producer.reviews.each do |review| %>
    <div class="card-product">
      <div class="card-product-infos">
        <%= review.content %>
        <% if policy(review).destroy? %>
          <%= link_to "Remove",
                    review_path(review),
                    method: :delete,
                    data: { confirm: "Are you sure?" } %>
        <%end%>
      </div>
    </div>
  <% end %>

</div>
